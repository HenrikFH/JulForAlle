<!DOCTYPE html>
<html>
<head>
	
	<meta content="width=device-width, initial-scale=1.0" name="viewport">
	<title>Registrering</title>
	<meta charset="utf-8" />
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.3.0/css/foundation-flex.css">
	<link rel="stylesheet" type="text/css" href="finalR.css" />
	<link href="https://fonts.googleapis.com/css?family=Oswald" rel="stylesheet">
	
	<link rel="stylesheet" type="text/css" href="sweetalert.css">

</head>
<body>

	<div class="top"></div>
	
	<script src="https://www.gstatic.com/firebasejs/3.7.3/firebase.js"></script>
	<script>
	  var config = {
   		apiKey: "AIzaSyAGep4GxcnomGeFciQDLHPI24A9cg6ULCk",
    	authDomain: "ikea-prosjekt.firebaseapp.com",
    	databaseURL: "https://ikea-prosjekt.firebaseio.com",
    	storageBucket: "ikea-prosjekt.appspot.com",
    	messagingSenderId: "368672913845"
 	 	};
 	 	firebase.initializeApp(config);
	</script>

	<script type="text/javascript">
		var tekstDatabase = firebase.database();
		var filDatabase  = firebase.storage();
		var Varer = tekstDatabase.ref("Varer"); 
	</script>
	
	<div class="box3">

		
		<h3>REGISTRER DEG HER: </h3>

		<div class="box1">
			<strong> <p "> Her kan du registrere deg forså velg kategori av hvem du vil feire jul sammen med!
			 Legg til Navn og mailadresse og trykk "Godkjenn".</p>  </strong>
		</div>

		<form id="regVarer">	

			<textarea  class="box2" id="inpVarenavn" type="text" required placeholder="Navn"></textarea>
			<textarea class="box2" id="inpPris" type="number" required placeholder="Mailadresse"></textarea>
			<textarea class="box2" id="inpVarenavn" type="text" required placeholder="Bekreft mailadresse"></textarea>
			<select class="box2" id="inpKategori">
				<option>Velg kategori</option>
				<option value="stue">Hjemme hos noen</option>
				<option value="soverom">Lokalet</option>
				<option value="kjøkken">Annet</option>
			</select>
			
			<br>

			<button class="button2" onclick="validation();">
			GODKJENN
			</button>

			<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>

			<script type="text/javascript">
			function validation()
			{

				swal("Fullført!", "All informasjonen blir sendt på mail!:-)", "success");

			}
		</script>	


		</form>

	</div>
</a>

	<script type="text/javascript">
		var regVarer = document.getElementById('regVarer');
		var inpVarenavn = document.getElementById('inpVarenavn');
		var inpPris = document.getElementById('inpPris');
		var inpKategori = document.getElementById('inpKategori');
		function leggTilData_i_Firebase(evt) {
			evt.preventDefault();
				varer.push({
					Varenavn:inpVarenavn.value,
					Pris:inpPris.value,
					Kategori:inpKategori.value,
					url:globalUrl
				});
		}
		regVarer.addEventListener("submit",leggTilData_i_Firebase);
	</script>	

		

	<script>
		var inpBilde  = document.getElementById('inpBilde');
		var bilde  = document.getElementById('bilde');
		var opplastingsProsent = document.getElementById('opplastingsProsent');
		var globalUrl = "";		
		function leggTilBilde(evt) {
			var file = evt.target.files[0];
			var bilder = filDatabase.ref("bilder/" + file.name);
			var mensBildeLastesNed = bilder.put(file);
			mensBildeLastesNed.on("state_changed",
				function progress(snapshot) {
					var prosent=(snapshot.bytesTransferred/snapshot.totalBytes)*100;
					opplastingsProsent.value = prosent;
				},
				function error(err){
					alert("Noe hendte - filen kan ikke lastes opp...");
				},
				function complete() {
					bilder.getDownloadURL().then(function(url){
											globalUrl=url;
											bilde.src=url
										});					
				}
			);
		}
		inpBilde.addEventListener("change", leggTilBilde);
	</script>




</body>
</html>